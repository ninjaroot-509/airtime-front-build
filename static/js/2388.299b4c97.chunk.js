"use strict";(self.webpackChunkbling=self.webpackChunkbling||[]).push([[2388],{1386:(e,a,s)=>{s.d(a,{R$:()=>r,ts:()=>i,uK:()=>t});var n=s(69525);function r(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MM-dd-yyyy";return(0,n.A)(new Date(e),a)}function i(e){return(0,n.A)(new Date(e),"dd MMMM yyyy")}function t(e){return(0,n.A)(new Date(e),"dd MMM yyyy HH:mm")}},21152:(e,a,s)=>{s.d(a,{A:()=>r});var n=s(65043);function r(e){const[a,s]=(0,n.useState)(e||"");return{currentTab:a,onChangeTab:(e,a)=>{s(a)},setCurrentTab:s}}},22388:(e,a,s)=>{s.r(a),s.d(a,{default:()=>I});var n=s(65043),r=s(19252),i=s(8939),t=s(24056),o=s(96446),l=(s(48407),s(21152)),d=s(11737),c=s(30342),m=(s(70140),s(19838)),u=s(20974),p=s(24753),h=s(49092),x=s(70579);var v=s(73033),j=s(83665),g=(s(73856),s(53335)),f=s(43409),b=s(65384),w=s(80907),A=s(63204);const y=(0,w.Z0)({name:"wallet",initialState:{isLoading:!1,error:null,wallet:{}},reducers:{startLoading(e){e.isLoading=!0},stopLoading(e){e.isLoading=!1},hasError(e,a){e.isLoading=!1,e.error=a.payload},getWalletSuccess(e,a){e.isLoading=!1,e.wallet=a.payload}}}),{startLoading:S,stopLoading:k}=(y.reducer,y.actions);var q=s(73338);var _=s(18403),P=s(24858),L=s(12110),N=s(88911),M=s(72812);function Y(){const{enqueueSnackbar:e}=(0,j.dh)(),{t:a}=(0,h.B)(),s=v.Ik().shape({oldPassword:v.Yj().required("Old Password is required"),newPassword:v.Yj().min(6,"Password must be at least 6 characters").required("New Password is required"),confirmNewPassword:v.Yj().oneOf([v.KR("newPassword"),null],"Passwords must match")}),n=(0,P.mN)({resolver:(0,_.t)(s),defaultValues:{oldPassword:"",newPassword:"",confirmNewPassword:""}}),{reset:r,handleSubmit:i,formState:{isSubmitting:t}}=n;return(0,x.jsx)(L.A,{sx:{p:3},children:(0,x.jsx)(g.Op,{methods:n,onSubmit:i((async a=>{try{const s=await A.A.put("/api/v1/accounts/update-password",a);r(),e(s.data)}catch(s){console.error(s),e(s.response.data,{variant:"error"})}})),children:(0,x.jsxs)(N.A,{spacing:3,alignItems:"flex-end",children:[(0,x.jsx)(g.o3,{name:"oldPassword",type:"password",label:a("params.oldpassword")}),(0,x.jsx)(g.o3,{name:"newPassword",type:"password",label:a("params.newpassword")}),(0,x.jsx)(g.o3,{name:"confirmNewPassword",type:"password",label:a("params.confpassword")}),(0,x.jsx)(M.A,{type:"submit",variant:"contained",loading:t,children:a("params.save")})]})})})}var C=s(68903),D=s(85865),O=s(1386),R=s(34866);function T(){const{user:e,update:a}=(0,c.A)(),s=(0,b.wA)(),{t:r}=(0,h.B)(),{countries:i,genres:t,maritals:l}=(0,b.d4)((e=>e.generale));(0,n.useEffect)((()=>{s((0,R.X6)()),s((0,R.HS)()),s((0,R.Gz)())}),[s]);const{enqueueSnackbar:d}=(0,j.dh)(),m=(0,f.A)(),u=v.Ik().shape({phone:v.Yj().required("phone is required"),firstName:v.Yj().required("firstName is required"),lastName:v.Yj().required("lastName is required"),email:v.Yj().email("Email must be a valid email address").required("email is required"),photo:v.gl().required("photo is required"),country:v.Yj().required("country is required"),description:v.Yj().required("description is required")}),p={phone:(null===e||void 0===e?void 0:e.phone)||"",firstName:(null===e||void 0===e?void 0:e.first_name)||"",lastName:(null===e||void 0===e?void 0:e.last_name)||"",username:(null===e||void 0===e?void 0:e.username)||"",email:(null===e||void 0===e?void 0:e.email)||"",photo:(null===e||void 0===e?void 0:e.photo)||"",country:(null===e||void 0===e?void 0:e.country)||"",description:(null===e||void 0===e?void 0:e.description)||"",city:(null===e||void 0===e?void 0:e.city)||"",address:(null===e||void 0===e?void 0:e.address)||"",genre:(null===e||void 0===e?void 0:e.genre)||"",marital:(null===e||void 0===e?void 0:e.marital)||""},[w,A]=(0,n.useState)(!1),y=(0,P.mN)({resolver:(0,_.t)(u),defaultValues:p}),{setValue:S,watch:k,setError:Y,handleSubmit:T,formState:{isSubmitting:B}}=y,I=k(),U=(0,n.useCallback)((e=>{const a=e[0];a&&S("photo",Object.assign(a,{preview:URL.createObjectURL(a)})),A(!0)}),[S]);return(0,x.jsx)(g.Op,{methods:y,onSubmit:T((async e=>{try{const s=new FormData;Object.entries(I).forEach((e=>{let[a,n]=e;["photo"].includes(a)||("born_date"===a?s.append(a,(0,O.R$)(n)):s.append(a,n))})),!0===w&&s.append("photo",e.photo),await a(s),d("Update success!")}catch(s){console.error(s),m.current&&(Y("afterSubmit",{...s,message:s.response.statusText}),s.response.data.phone&&Y("phone",{...s,message:s.response.data.phone}),s.response.data.username&&Y("username",{...s,message:s.response.data.username}),s.response.data.email?Y("email",{...s,message:s.response.data.email}):s.response.data.non_field_errors&&Y("email",{...s,message:s.response.data.non_field_errors}),s.response.data.photo&&Y("photo",{...s,message:s.response.data.photo}))}})),children:(0,x.jsxs)(C.Ay,{container:!0,spacing:3,children:[(0,x.jsx)(C.Ay,{item:!0,xs:12,md:4,children:(0,x.jsx)(L.A,{sx:{py:10,px:3,textAlign:"center"},children:(0,x.jsx)(g.BF,{name:"photo",accept:"image/*",maxSize:3145728,onDrop:U,helperText:(0,x.jsxs)(D.A,{variant:"caption",sx:{mt:2,mx:"auto",display:"block",textAlign:"center",color:"text.secondary"},children:["Allowed *.jpeg, *.jpg, *.png, *.gif",(0,x.jsx)("br",{})," max size of ",(0,q.tm)(3145728)]})})})}),(0,x.jsx)(C.Ay,{item:!0,xs:12,md:8,children:(0,x.jsxs)(L.A,{sx:{p:3},children:[(0,x.jsxs)(o.A,{sx:{display:"grid",rowGap:3,columnGap:2,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[(0,x.jsx)(g.o3,{type:"email",name:"email",label:r("field.email")}),(0,x.jsx)(g.nU,{name:"phone",label:r("field.phone")}),(0,x.jsx)(g.o3,{name:"first_name",label:r("field.first_name")}),(0,x.jsx)(g.o3,{name:"last_name",label:r("field.last_name")}),(0,x.jsx)(g.zl,{name:"born_date",maxDate:new Date,label:r("field.born_date")}),(0,x.jsxs)(g.tX,{name:"genre",label:r("field.genre"),placeholder:r("field.genre"),children:[(0,x.jsx)("option",{value:""}),null===t||void 0===t?void 0:t.map((e=>(0,x.jsx)("option",{value:e,children:r(`genre.${e}`)},e)))]}),(0,x.jsxs)(g.tX,{name:"marital",label:r("field.marital"),placeholder:r("field.marital"),children:[(0,x.jsx)("option",{value:""}),null===l||void 0===l?void 0:l.map((e=>(0,x.jsx)("option",{value:e,children:r(`marital.${e}`)},e)))]}),(0,x.jsxs)(g.tX,{name:"country",label:r("field.country"),placeholder:r("field.country"),children:[(0,x.jsx)("option",{value:""}),null===i||void 0===i?void 0:i.map((e=>(0,x.jsx)("option",{value:e.id,children:r(`country.${e.name}`)},e.id)))]}),(0,x.jsx)(g.o3,{name:"city",label:r("field.city")})]}),(0,x.jsxs)(N.A,{spacing:3,alignItems:"flex-end",sx:{mt:3},children:[(0,x.jsx)(g.o3,{name:"description",multiline:!0,rows:4,label:"Description"}),(0,x.jsx)(M.A,{type:"submit",variant:"contained",loading:B,children:r("params.save_change")})]})]})})]})})}s(61476),s(93488);u.A,u.A,u.A,u.A;var B=s(73216);function I(){(0,b.wA)();const e=(0,B.zy)(),a=new URLSearchParams(e.search).get("menu"),{t:s}=(0,h.B)(),{user:n,refresh:v}=(0,c.A)(),{themeStretch:j}=(0,d.A)(),{currentTab:g,onChangeTab:f}=(0,l.A)(a||"profile"),w=[{value:"profile",icon:(0,x.jsx)(u.A,{icon:"mdi:user-edit",width:20,height:20}),component:(0,x.jsx)(T,{})},{value:"change_password",icon:(0,x.jsx)(u.A,{icon:"ic:round-vpn-key",width:20,height:20}),component:(0,x.jsx)(Y,{})}];return(0,x.jsx)(m.A,{title:"User: Account Settings",children:(0,x.jsxs)(r.A,{maxWidth:!j&&"lg",children:[(0,x.jsx)(p.A,{heading:s("params.account"),links:[{name:s("params.account_setting")}]}),(0,x.jsx)(i.A,{allowScrollButtonsMobile:!0,variant:"scrollable",scrollButtons:"auto",value:g,onChange:f,children:w.map((e=>(0,x.jsx)(t.A,{disableRipple:!0,label:s("params."+e.value),icon:e.icon,value:e.value},e.value)))}),(0,x.jsx)(o.A,{sx:{mb:5}}),w.map((e=>e.value===g&&(0,x.jsx)(o.A,{children:e.component},e.value)))]})})}},24753:(e,a,s)=>{s.d(a,{A:()=>p});var n=s(90620),r=s.n(n),i=s(96446),t=s(85865),o=s(88446),l=s(35475),d=s(22698),c=s(70579);function m(e){let{links:a,activeLast:s=!1,...n}=e;const r=a[a.length-1].name,o=a.map((e=>(0,c.jsx)(u,{link:e},e.name))),l=a.map((e=>(0,c.jsx)("div",{children:e.name!==r?(0,c.jsx)(u,{link:e}):(0,c.jsx)(t.A,{variant:"body2",sx:{maxWidth:260,overflow:"hidden",whiteSpace:"nowrap",color:"text.disabled",textOverflow:"ellipsis"},children:r})},e.name)));return(0,c.jsx)(d.A,{separator:(0,c.jsx)(i.A,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}}),...n,children:s?o:l})}function u(e){let{link:a}=e;const{href:s,name:n,icon:r}=a;return(0,c.jsxs)(o.A,{variant:"body2",component:l.N_,to:s||"#",sx:{lineHeight:2,display:"flex",alignItems:"center",color:"text.primary","& > div":{display:"inherit"}},children:[r&&(0,c.jsx)(i.A,{sx:{mr:1,"& svg":{width:20,height:20}},children:r}),n]},n)}function p(e){let{links:a,action:s,heading:n,moreLink:l=[],sx:d,...u}=e;return(0,c.jsxs)(i.A,{sx:{mb:5,...d},children:[(0,c.jsxs)(i.A,{sx:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)(i.A,{sx:{flexGrow:1},children:[(0,c.jsx)(t.A,{variant:"h4",gutterBottom:!0,children:n}),(0,c.jsx)(m,{links:a,...u})]}),s&&(0,c.jsx)(i.A,{sx:{flexShrink:0},children:s})]}),(0,c.jsx)(i.A,{sx:{mt:2},children:r()(l)?(0,c.jsx)(o.A,{href:l,target:"_blank",rel:"noopener",variant:"body2",children:l}):l.map((e=>(0,c.jsx)(o.A,{noWrap:!0,href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)))})]})}}}]);
//# sourceMappingURL=2388.299b4c97.chunk.js.map